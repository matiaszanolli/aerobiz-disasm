; ============================================================================
; FillTileRect -- Fill rectangular VRAM area with repeating tile pattern
; Called: 17 times.
; 362 bytes | $006760-$0068C9
; ============================================================================
FillTileRect:                                                  ; $006760
    link    a6,#-$24
    movem.l d2-d7/a2-a4,-(sp)
    move.l  $0020(a6),d2
    move.l  $0014(a6),d4
    move.l  $000c(a6),d5
    move.l  $0008(a6),d6
    move.l  $0024(a6),d7
    lea     -$0020(a6),a2
    lea     -$0022(a6),a3
    lea     $001a(a6),a4
    tst.w   d4
    ble.w   .l68c0
    tst.w   (a4)
    ble.w   .l68c0
    move.w  d5,d0
    ext.l   d0
    move.w  d4,d1
    ext.l   d1
    add.l   d1,d0
    moveq   #$20,d1
    cmp.l   d0,d1
    bge.w   .l6846
    moveq   #$20,d0
    sub.w   d5,d0
    move.w  d0,(a3)
    move.w  d2,d3
    moveq   #$c,d0
    lsl.w   d0,d3
    move.w  d2,d0
    lsl.w   #$8,d0
    or.l    d0,d3
    move.w  d2,d0
    lsl.w   #$4,d0
    or.l    d0,d3
    or.w    d2,d3
    pea     ($0020).w
    move.w  d3,d0
    move.l  d0,-(sp)
    move.l  a2,-(sp)
    dc.w    $4eb9,$0001,$d520                           ; jsr $01D520
    move.w  d6,d0
    ext.l   d0
    move.l  d0,-(sp)
    move.l  a2,-(sp)
    pea     ($0001).w
    move.w  d7,d0
    ext.l   d0
    move.l  d0,-(sp)
    dc.w    $4eb9,$0001,$d568                           ; jsr $01D568
    lea     $001c(sp),sp
    move.w  d6,d0
    add.w   d0,d0
    movea.l #$0005f92e,a0
    move.w  (a0,d0.w),d3
    andi.l  #$ffff,d3
    asr.l   #$5,d3
    add.w   d7,d3
    move.w  $001e(a6),d0
    moveq   #$d,d1
    lsl.w   d1,d0
    or.l    d0,d3
    moveq   #$0,d0
    move.w  d3,d0
    move.l  d0,-(sp)
    move.w  (a4),d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  (a3),d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  $0012(a6),d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  d5,d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  d6,d0
    ext.l   d0
    move.l  d0,-(sp)
    pea     ($001A).w
    dc.w    $4eb9,$0000,$0d64                           ; jsr $000D64
    lea     $001c(sp),sp
    sub.w   (a3),d4
    clr.w   d5
.l6846:                                                 ; $006846
    move.w  d2,d3
    moveq   #$c,d0
    lsl.w   d0,d3
    move.w  d2,d0
    lsl.w   #$8,d0
    or.l    d0,d3
    move.w  d2,d0
    lsl.w   #$4,d0
    or.l    d0,d3
    or.w    d2,d3
    pea     ($0020).w
    move.w  d3,d0
    move.l  d0,-(sp)
    move.l  a2,-(sp)
    dc.w    $4eb9,$0001,$d520                           ; jsr $01D520
    move.w  d6,d0
    ext.l   d0
    move.l  d0,-(sp)
    move.l  a2,-(sp)
    pea     ($0001).w
    move.w  d7,d0
    ext.l   d0
    move.l  d0,-(sp)
    dc.w    $4eb9,$0001,$d568                           ; jsr $01D568
    lea     $001c(sp),sp
    move.w  $001e(a6),d3
    moveq   #$d,d0
    lsl.w   d0,d3
    or.w    d7,d3
    moveq   #$0,d0
    move.w  d3,d0
    move.l  d0,-(sp)
    move.w  (a4),d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  d4,d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  $0012(a6),d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  d5,d0
    ext.l   d0
    move.l  d0,-(sp)
    move.w  d6,d0
    ext.l   d0
    move.l  d0,-(sp)
    pea     ($001A).w
    dc.w    $4eb9,$0000,$0d64                           ; jsr $000D64
.l68c0:                                                 ; $0068C0
    movem.l -$0048(a6),d2-d7/a2-a4
    unlk    a6
    rts
